<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Projetos de Rede - SID 98</title>
    <style>
        :root { --win-grey: #C0C0C0; --win-blue: #000080; --win-white: #FFFFFF; --win-dark: #808080; --win-black: #000000; }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { background-color: #55aaaa; font-family: 'Tahoma', 'Segoe UI', sans-serif; padding: 10px; min-height: 100vh; }
        .window { background-color: var(--win-grey); border-top: 2px solid #fff; border-left: 2px solid #fff; border-right: 2px solid #000; border-bottom: 2px solid #000; max-width: 950px; margin: 0 auto; box-shadow: 5px 5px 15px rgba(0,0,0,0.3); }
        .title-bar { background: linear-gradient(90deg, var(--win-blue), #1084d0); padding: 3px 5px; display: flex; justify-content: space-between; align-items: center; margin: 3px; }
        .title-text { color: white; font-weight: bold; font-size: 13px; } .title-controls { display: flex; gap: 2px; }
        .btn-win-ctrl { width: 16px; height: 14px; background: var(--win-grey); border-top: 1px solid #fff; border-left: 1px solid #fff; border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 9px; display: flex; align-items: center; justify-content: center; cursor: pointer; }
        .menu-bar { display: flex; gap: 10px; padding: 2px 10px; border-bottom: 1px solid #808080; margin-bottom: 10px; }
        .menu-opt { font-size: 13px; cursor: pointer; } .menu-opt:hover { background-color: var(--win-blue); color: white; }
        .window-body { padding: 15px; }
        fieldset { border: 2px groove #fff; padding: 10px; margin-bottom: 15px; } legend { font-size: 12px; margin-left: 10px; padding: 0 5px; color: #000; }
        .row { display: flex; gap: 15px; margin-bottom: 10px; } .col { flex: 1; } label { display: block; font-size: 12px; margin-bottom: 3px; }
        input, select, textarea { width: 100%; background-color: #fff; border-top: 2px solid #808080; border-left: 2px solid #808080; border-right: 2px solid #fff; border-bottom: 2px solid #fff; padding: 3px; font-size: 13px; font-family: 'Tahoma', sans-serif; border-radius: 0; outline: none; }
        .calc-input { background-color: #000; color: #0f0; border: 2px inset #fff; font-family: 'Courier New', monospace; font-weight: bold; text-align: right; }
        .saldo-input { background-color: #000; color: yellow; border: 2px inset #fff; font-family: 'Courier New', monospace; font-weight: bold; text-align: right; }
        .btn-main { padding: 8px 20px; background: var(--win-grey); border-top: 2px solid #fff; border-left: 2px solid #fff; border-right: 2px solid #000; border-bottom: 2px solid #000; font-weight: bold; font-size: 13px; cursor: pointer; width: 100%; }
        .btn-main:active { border-top: 2px solid #000; border-left: 2px solid #000; border-right: 2px solid #fff; border-bottom: 2px solid #fff; transform: translate(1px, 1px); }
        @media (max-width: 768px) { .row { flex-direction: column; gap: 5px; } }
    </style>
</head>
<body>
    <div class="window">
        <div class="title-bar"><div class="title-text">Gestão de Projetos e Rede - [Novo Registro]</div><div class="title-controls"><div class="btn-win-ctrl" onclick="window.location.href='index.html'">_</div><div class="btn-win-ctrl">□</div><div class="btn-win-ctrl" onclick="window.location.href='index.html'">X</div></div></div>
        <div class="menu-bar"><div class="menu-opt" onclick="window.location.href='index.html'"><u>A</u>rquivo</div><div class="menu-opt"><u>E</u>ditar</div><div class="menu-opt"><u>A</u>juda</div></div>
        <div class="window-body">
            <iframe name="hidden_iframe" id="hidden_iframe" style="display:none;" onload="if(submitted) {finalizarEnvio();}"></iframe>
            <form id="formRede" action="https://script.google.com/macros/s/AKfycbwfF9bVzieRqpT83NKvnlS21ioW9SNckTQ7mkkg2afBqV6yWfBXHrvI00XThIPu-hGx5w/exec" method="post" target="hidden_iframe" onsubmit="submitted=true; iniciarEnvio();">
                <input type="hidden" name="AbaDestino" value="REDE">
                <input type="hidden" id="dataAtual" name="Data">
                <fieldset><legend>Identificação do Projeto</legend><div class="row"><div class="col" style="flex: 0.5;"><label>DC (Sigla)</label><input type="text" name="DC" required></div><div class="col" style="flex: 2;"><label>Descrição do Projeto</label><input type="text" name="Descricao1" required></div><div class="col"><label>Nº Contrato</label><input type="text" name="Contrato"></div></div></fieldset>
                <fieldset><legend>Classificação Técnica</legend><div class="row"><div class="col"><label>Tipo de Serviço</label><input type="text" name="Tipo_Servico"></div><div class="col"><label>Tipo de Projeto</label><input type="text" name="Tipo_Projeto"></div><div class="col"><label>Seguimento</label><input type="text" name="Seguimento"></div></div><div class="row"><div class="col"><label>Micro Área</label><input type="text" name="Micro_Area"></div><div class="col"><label>Classificação</label><input type="text" name="Classificacao"></div></div></fieldset>
                <fieldset><legend>Status e Responsabilidade</legend><div class="row"><div class="col"><label>Status Atual</label><select name="Status"><option value="ANALISE">EM ANÁLISE</option><option value="EXECUCAO">EM EXECUÇÃO</option><option value="MEDICAO">EM MEDIÇÃO</option><option value="CONCLUIDO">CONCLUÍDO</option><option value="PARALISADO">PARALISADO</option></select></div><div class="col"><label>Responsável</label><input type="text" name="Responsavel"></div></div></fieldset>
                <fieldset><legend>Detalhamento</legend><div class="row"><div class="col"><label>Serviços</label><input type="text" name="Servicos"></div></div><label>Descrição Técnica Detalhada</label><textarea rows="4" name="Desc_Servico" style="overflow-y: scroll;"></textarea></fieldset>
                <fieldset style="border-color: #808080;"><legend style="font-weight:bold; color:blue;">Medição e Valores</legend><div class="row"><div class="col"><label>Qtd. Orçada</label><input type="number" step="0.01" id="qtdOrcada" class="calc-input" placeholder="0.00" name="Qtd_Orcada" oninput="calcularSaldo()"></div><div class="col"><label>Qtd. Medida</label><input type="number" step="0.01" id="qtdMedida" class="calc-input" placeholder="0.00" name="Qtd_Medida" oninput="calcularSaldo()"></div><div class="col"><label>Saldo (Qtd)</label><input type="text" id="saldoQtd" class="saldo-input" placeholder="0.00" name="Saldo_Qtd" readonly></div></div><div class="row"><div class="col"><label>Moeda</label><select name="Moeda"><option>BRL (R$)</option><option>USD (US$)</option></select></div><div class="col"><label>Valor Orçado</label><input type="text" name="Orcado_Moeda"></div><div class="col"><label>Valor Medido</label><input type="text" name="Medido_Moeda"></div></div></fieldset>
                <div style="margin-top: 20px; text-align: right;"><button type="submit" class="btn-main">Gravar Registro</button></div>
            </form>
        </div>
        <div style="border-top: 1px solid #808080; padding: 3px; font-size: 11px; color: #444; margin-top: 5px;">Pronto para digitar...</div>
    </div>
    <script>
        var submitted = false;
        window.onload = function() { var hoje = new Date(); document.getElementById('dataAtual').value = hoje.toLocaleDateString('pt-BR'); }
        function calcularSaldo() { var orcada = parseFloat(document.getElementById('qtdOrcada').value) || 0; var medida = parseFloat(document.getElementById('qtdMedida').value) || 0; var saldo = orcada - medida; document.getElementById('saldoQtd').value = saldo.toFixed(2); }
        function iniciarEnvio() { var btn = document.querySelector('.btn-main'); btn.disabled = true; btn.innerHTML = "Enviando dados..."; document.body.style.cursor = 'wait'; }
        function finalizarEnvio() { alert("Informação do Sistema:\n\nDados gravados com sucesso na base REDE."); window.location.href = "index.html"; }
    </script>
</body>
</html>